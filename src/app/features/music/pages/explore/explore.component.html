<div class="min-h-screen bg-blue-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Content Type Switcher (Tabs) -->
    <div class="flex justify-center mb-6">
      <div class="inline-flex rounded-lg border border-gray-300 bg-white p-1 shadow-sm">
        <button
          (click)="switchContentType('songs')"
          [class.bg-blue-600]="currentContentType === 'songs'"
          [class.text-white]="currentContentType === 'songs'"
          [class.text-gray-700]="currentContentType !== 'songs'"
          [class.hover:bg-gray-100]="currentContentType !== 'songs'"
          class="px-6 py-2 rounded-md font-medium text-sm transition-all duration-200 flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
          </svg>
          Canciones
        </button>
        <button
          (click)="switchContentType('albums')"
          [class.bg-blue-600]="currentContentType === 'albums'"
          [class.text-white]="currentContentType === 'albums'"
          [class.text-gray-700]="currentContentType !== 'albums'"
          [class.hover:bg-gray-100]="currentContentType !== 'albums'"
          class="px-6 py-2 rounded-md font-medium text-sm transition-all duration-200 flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
          Álbumes
        </button>
        <button
          (click)="switchContentType('artists')"
          [class.bg-blue-600]="currentContentType === 'artists'"
          [class.text-white]="currentContentType === 'artists'"
          [class.text-gray-700]="currentContentType !== 'artists'"
          [class.hover:bg-gray-100]="currentContentType !== 'artists'"
          class="px-6 py-2 rounded-md font-medium text-sm transition-all duration-200 flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
          Artistas
        </button>
      </div>
    </div>

    <!-- Search + Filters in ONE ROW - CENTERED -->
    <div class="flex flex-wrap items-center justify-center gap-4 mb-4">

      <!-- Search bar -->
      <div class="w-full sm:w-auto sm:flex-1 sm:min-w-[280px] sm:max-w-[450px]">
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </div>
          <input
            type="text"
            [(ngModel)]="filters.searchTerm"
            (ngModelChange)="onFilterChange()"
            [placeholder]="currentContentType === 'songs' ? 'Buscar canciones ...' : currentContentType === 'albums' ? 'Buscar álbumes ...' : 'Buscar artistas ...'"
            class="block w-full pr-3 filter-control search-control"
          />
        </div>
      </div>

      <!-- Price Range (only for songs and albums) -->
      <div *ngIf="currentContentType !== 'artists'" class="flex items-center gap-2">
        <label class="filter-label whitespace-nowrap">Precio:</label>

        <div class="flex items-center gap-1">
          <input
            type="number"
            [(ngModel)]="filters.priceRange.min"
            (ngModelChange)="onFilterChange()"
            [min]="0"
            [max]="filters.priceRange.max || 100"
            step="0.50"
            placeholder="0.00"
            class="w-20 text-center text-sm filter-control
                   [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
          />
          <span class="text-xs text-gray-500">€</span>
        </div>

        <span class="text-gray-400">—</span>

        <div class="flex items-center gap-1">
          <input
            type="number"
            [(ngModel)]="filters.priceRange.max"
            (ngModelChange)="onFilterChange()"
            [min]="filters.priceRange.min || 0"
            [max]="100"
            step="0.50"
            placeholder="100.00"
            class="w-20 text-center text-sm filter-control
                   [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
          />
          <span class="text-xs text-gray-500">€</span>
        </div>
      </div>

      <!-- Genre / Trending -->
      <select
        [(ngModel)]="filters.genre"
        (ngModelChange)="onFilterChange()"
        class="filter-control cursor-pointer"
      >
        <ng-container *ngIf="currentContentType !== 'artists'">
          <option value="">Todos los géneros</option>
          <option *ngFor="let genre of availableGenres" [value]="genre">{{ genre }}</option>
        </ng-container>
        <ng-container *ngIf="currentContentType === 'artists'">
          <option value="">Todos los artistas</option>
          <option value="trending">En Tendencia</option>
        </ng-container>
      </select>

      <!-- Sort -->
      <select
        [(ngModel)]="filters.sortBy"
        (ngModelChange)="onFilterChange()"
        class="filter-control cursor-pointer"
      >
        <option *ngFor="let option of visibleSortOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>

    </div>

    <!-- Results count -->
    <div class="text-sm text-neutral mb-6">
      <ng-container *ngIf="currentContentType === 'songs'">
        Mostrando {{ displayedSongs.length }} de {{ totalSongs }} canciones
      </ng-container>
      <ng-container *ngIf="currentContentType === 'albums'">
        Mostrando {{ displayedAlbums.length }} de {{ totalAlbums }} álbumes
      </ng-container>
      <ng-container *ngIf="currentContentType === 'artists'">
        Mostrando {{ displayedArtists.length }} de {{ totalArtists }} artistas
      </ng-container>
    </div>

    <!-- Loading inicial -->
    <div *ngIf="isLoading && !isLoadingMore" class="flex justify-center items-center py-20">
      <div class="text-center">
        <div class="loading-spinner mx-auto mb-4"></div>
        <p class="text-gray-600">Cargando {{ currentContentType === 'songs' ? 'canciones' : currentContentType === 'albums' ? 'álbumes' : 'artistas' }}...</p>
      </div>
    </div>

    <!-- Songs Grid con animación -->
    <div *ngIf="!isLoading && currentContentType === 'songs' && displayedSongs.length > 0"
         class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
      <app-song-card
        *ngFor="let song of displayedSongs; let i = index"
        [song]="song"
        [isCurrentSong]="song.id === currentSongId"
        [isPlaying]="isSongPlaying"
        [canFavorite]="canShowFavoriteActions"
        [class.fade-in-item]="i >= displayedSongs.length - itemsPerPage"
        (toggleFavorite)="onToggleFavoriteSong($event)"
        (playSong)="onPlaySong($event)"
        (pauseSong)="onPauseSong()"
        (addToCart)="onAddSongToCart($event)"
      ></app-song-card>
    </div>

    <!-- Albums Grid con animación -->
    <div *ngIf="!isLoading && currentContentType === 'albums' && displayedAlbums.length > 0"
         class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
      <app-album-card
        *ngFor="let album of displayedAlbums; let i = index"
        [album]="album"
        [isCurrentAlbum]="isAlbumCurrentlySelected(album)"
        [isPlaying]="isSongPlaying"
        [canFavorite]="canShowFavoriteActions"
        [class.fade-in-item]="i >= displayedAlbums.length - itemsPerPage"
        (toggleFavorite)="onToggleFavoriteAlbum($event)"
        (playAlbum)="onPlayAlbum($event)"
        (addToCart)="onAddAlbumToCart($event)"
      ></app-album-card>
    </div>

    <!-- Artists Grid con animación -->
    <div *ngIf="!isLoading && currentContentType === 'artists' && displayedArtists.length > 0"
         class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
      <app-artist-card
        *ngFor="let artist of displayedArtists; let i = index"
        [artist]="artist"
        [class.fade-in-item]="i >= displayedArtists.length - itemsPerPage"
      ></app-artist-card>
    </div>

    <!-- Loading more spinner (scroll infinito con texto) -->
    <div *ngIf="isLoadingMore" class="flex flex-col items-center justify-center py-12">
      <div class="loading-spinner mb-4"></div>
      <p class="text-gray-600 text-sm animate-pulse">
        Cargando más {{ currentContentType === 'songs' ? 'canciones' : currentContentType === 'albums' ? 'álbumes' : 'artistas' }}...
      </p>
    </div>

    <!-- No results -->
    <div *ngIf="!isLoading &&
                    ((currentContentType === 'songs' && displayedSongs.length === 0) ||
                     (currentContentType === 'albums' && displayedAlbums.length === 0) ||
                     (currentContentType === 'artists' && displayedArtists.length === 0))"
         class="text-center py-20">
      <svg class="mx-auto h-24 w-24 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h3 class="text-xl font-semibold text-gray-900 mb-2">
        No se encontraron {{ currentContentType === 'songs' ? 'canciones' : currentContentType === 'albums' ? 'álbumes' : 'artistas' }}
      </h3>
      <p class="text-neutral">Intenta ajustar tus filtros de búsqueda</p>
    </div>

    <!-- Floating Music Player -->
    <app-music-player
      [isVisible]="showPlayer"
      (close)="onClosePlayer()"
      (toggleFavorite)="onToggleFavoriteSong($event)"
    ></app-music-player>

  </div>
</div>
