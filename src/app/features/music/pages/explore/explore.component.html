<div class="min-h-screen bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Content Type Switcher (Tabs) -->
    <div class="flex justify-center mb-6">
      <div class="inline-flex rounded-lg border border-gray-300 bg-white p-1 shadow-sm">
        <button
          (click)="switchContentType('songs')"
          [class.bg-blue-600]="currentContentType === 'songs'"
          [class.text-white]="currentContentType === 'songs'"
          [class.text-gray-700]="currentContentType !== 'songs'"
          [class.hover:bg-gray-100]="currentContentType !== 'songs'"
          class="px-6 py-2 rounded-md font-medium text-sm transition-all duration-200 flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
          </svg>
          Canciones
        </button>
        <button
          (click)="switchContentType('albums')"
          [class.bg-blue-600]="currentContentType === 'albums'"
          [class.text-white]="currentContentType === 'albums'"
          [class.text-gray-700]="currentContentType !== 'albums'"
          [class.hover:bg-gray-100]="currentContentType !== 'albums'"
          class="px-6 py-2 rounded-md font-medium text-sm transition-all duration-200 flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
          Álbumes
        </button>
      </div>
    </div>

    <!-- Search + Filters in ONE ROW - CENTERED -->
    <div class="flex flex-wrap items-center justify-center gap-4 mb-4">

      <!-- Search bar -->
      <div class="w-full sm:w-auto sm:flex-1 sm:min-w-[280px] sm:max-w-[450px]">
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </div>
          <input
            type="text"
            [(ngModel)]="filters.searchTerm"
            (ngModelChange)="onFilterChange()"
            [placeholder]="currentContentType === 'songs' ? 'Buscar canciones, artistas...' : 'Buscar álbumes, artistas...'"
            class="block w-full pr-3 filter-control search-control"
          />
        </div>
      </div>

      <!-- Price Range - Compact -->
      <div class="flex items-center gap-1.5">
        <label class="filter-label whitespace-nowrap">Precio:</label>

        <input
          type="number"
          [(ngModel)]="filters.priceRange.min"
          (ngModelChange)="onFilterChange()"
          min="0"
          [max]="filters.priceRange.max"
          step="0.5"
          class="w-16 text-center text-sm filter-control
                     [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        />

        <span class="text-gray-400">-</span>

        <input
          type="number"
          [(ngModel)]="filters.priceRange.max"
          (ngModelChange)="onFilterChange()"
          min="0"
          [max]="currentContentType === 'songs' ? 20 : 50"
          step="0.5"
          class="w-16 text-center text-sm filter-control
                     [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        />

        <span class="text-sm text-gray-700">€</span>
      </div>

      <!-- Genre -->
      <select
        [(ngModel)]="filters.genre"
        (ngModelChange)="onFilterChange()"
        class="filter-control cursor-pointer"
      >
        <option value="">Todos los géneros</option>
        <option *ngFor="let genre of availableGenres" [value]="genre">{{ genre }}</option>
      </select>

      <!-- Sort -->
      <select
        [(ngModel)]="filters.sortBy"
        (ngModelChange)="onFilterChange()"
        class="filter-control cursor-pointer"
      >
        <option value="most_recent">Más recientes</option>
        <option value="oldest">Más antiguos</option>
        <option *ngIf="currentContentType === 'songs'" value="most_played">Más reproducidos</option>
        <option value="best_rated">Mejor valorados</option>
        <option value="price_asc">Precio: menor a mayor</option>
        <option value="price_desc">Precio: mayor a menor</option>
      </select>

    </div>

    <!-- Results count & pagination info -->
    <div class="text-sm text-neutral mb-6 flex items-center justify-between">
      <div>
        <ng-container *ngIf="currentContentType === 'songs'">
          Mostrando {{ displayedSongs.length }} de {{ totalSongs }} canciones
        </ng-container>
        <ng-container *ngIf="currentContentType === 'albums'">
          Mostrando {{ displayedAlbums.length }} de {{ totalAlbums }} álbumes
        </ng-container>
      </div>

      <!-- Pagination controls -->
      <div *ngIf="totalPages > 1" class="flex items-center gap-2">
        <button
          (click)="previousPage()"
          [disabled]="currentPage === 1"
          [class.opacity-50]="currentPage === 1"
          [class.cursor-not-allowed]="currentPage === 1"
          class="px-3 py-1 text-sm border border-gray-300 rounded-lg hover:bg-gray-100 disabled:hover:bg-white"
        >
          Anterior
        </button>
        <span class="text-sm text-gray-600">
          Página {{ currentPage }} de {{ totalPages }}
        </span>
        <button
          (click)="nextPage()"
          [disabled]="currentPage === totalPages"
          [class.opacity-50]="currentPage === totalPages"
          [class.cursor-not-allowed]="currentPage === totalPages"
          class="px-3 py-1 text-sm border border-gray-300 rounded-lg hover:bg-gray-100 disabled:hover:bg-white"
        >
          Siguiente
        </button>
      </div>
    </div>

    <!-- Loading spinner -->
    <div *ngIf="isLoading" class="flex items-center justify-center py-20">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
    </div>

    <!-- Songs Grid -->
    <div *ngIf="!isLoading && currentContentType === 'songs' && displayedSongs.length > 0"
         class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
      <app-song-card
        *ngFor="let song of displayedSongs"
        [song]="song"
        [isCurrentSong]="song.id === currentSongId"
        [isPlaying]="isSongPlaying"
        (toggleFavorite)="onToggleFavoriteSong($event)"
        (playSong)="onPlaySong($event)"
        (pauseSong)="onPauseSong()"
      ></app-song-card>
    </div>

    <!-- Albums Grid -->
    <div *ngIf="!isLoading && currentContentType === 'albums' && displayedAlbums.length > 0"
         class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
      <app-album-card
        *ngFor="let album of displayedAlbums"
        [album]="album"
        [isCurrentAlbum]="isAlbumCurrentlySelected(album)"
        [isPlaying]="isSongPlaying"
        (toggleFavorite)="onToggleFavoriteAlbum($event)"
        (playAlbum)="onPlayAlbum($event)"
      ></app-album-card>
    </div>

    <!-- No results -->
    <div *ngIf="!isLoading &&
                    ((currentContentType === 'songs' && displayedSongs.length === 0) ||
                     (currentContentType === 'albums' && displayedAlbums.length === 0))"
         class="text-center py-20">
      <svg class="mx-auto h-24 w-24 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h3 class="text-xl font-semibold text-gray-900 mb-2">
        No se encontraron {{ currentContentType === 'songs' ? 'canciones' : 'álbumes' }}
      </h3>
      <p class="text-neutral">Intenta ajustar tus filtros de búsqueda</p>
    </div>

    <!-- Floating Music Player -->
    <app-music-player
      [isVisible]="showPlayer"
      (close)="onClosePlayer()"
      (toggleFavorite)="onToggleFavoriteSong($event)"
    ></app-music-player>

  </div>
</div>

