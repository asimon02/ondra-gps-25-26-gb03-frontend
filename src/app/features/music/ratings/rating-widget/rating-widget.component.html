<div class="bg-white border border-gray-100 rounded-xl p-4 shadow-xl flex flex-col gap-3">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-xs font-semibold text-gray-500 uppercase tracking-wide">
    <span>Valoracion media</span>
    <div class="flex">
      <span>Valorar este contenido</span>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-700">
    <div class="flex items-center gap-3 flex-wrap">
      <div class="flex items-center gap-2">
        <app-star-rating [rating]="averageRounded" [readonly]="true"></app-star-rating>
        <span class="text-lg font-semibold text-gray-900">
          {{ average !== null ? (average | number:'1.1-1') : 'Sin valoraciones' }}
        </span>
      </div>
      <span *ngIf="hasRatings" class="text-sm text-gray-500">({{ average | number:'1.1-1' }} / 5)</span>
      <span *ngIf="!hasRatings" class="text-sm text-gray-500">Se el primero en valorar</span>
    </div>

    <div class="flex flex-col gap-1 items-start md:items-start">
      <div class="flex items-center gap-2 flex-wrap">
        <app-star-rating
          [rating]="userRating?.valor || 0"
          [readonly]="!isAuthenticated || isSaving || isRemoving"
          (rated)="onRated($event)"
        ></app-star-rating>
        <span class="text-sm">
          {{ userRating ? 'Actualizar valoracion' : 'Selecciona tu valoracion' }}
        </span>
      </div>
      <div class="flex items-center gap-2 text-xs text-gray-500" *ngIf="userRating">
        <span class="font-semibold text-blue-600">{{ userRating.valor }} / 5</span>
        <button
          type="button"
          (click)="onDeleteRating()"
          [disabled]="isRemoving"
          class="text-red-600 hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Quitar
        </button>
        <span *ngIf="userRating.editada" class="text-gray-400">Editada</span>
      </div>
      <p *ngIf="!isAuthenticated" class="text-xs text-gray-500">Inicia sesion para valorar.</p>
      <p *ngIf="errorMessage" class="text-xs text-red-600">{{ errorMessage }}</p>
    </div>
  </div>
</div>
