<!-- src/app/features/cart/cart.component.html -->

<div class="cart-container">
  <div class="cart-header">
    <h1 class="cart-title">Carrito de Compras</h1>
    @if (cartSummary().itemCount > 0) {
      <button 
        class="clear-cart-btn" 
        (click)="clearCart()"
        type="button">
        Vaciar carrito
      </button>
    }
  </div>

  @if (cartSummary().itemCount === 0) {
    <!-- Carrito vacío -->
    <div class="empty-cart">
      <svg class="empty-cart-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
          d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
        </path>
      </svg>
      <h2 class="empty-cart-title">Tu carrito está vacío</h2>
      <p class="empty-cart-text">Explora nuestra colección de música y añade tus canciones y álbumes favoritos</p>
      <a href="/home" class="browse-btn">Explorar música</a>
    </div>
  } @else {
    <!-- Lista de productos -->
    <div class="cart-content">
      <div class="cart-items">
        @for (item of cartSummary().items; track item.id) {
          <div class="cart-item">
            <img 
              [src]="item.imagen" 
              [alt]="item.titulo"
              class="item-image">
            
            <div class="item-details">
              <h3 class="item-title">{{ item.titulo }}</h3>
              <p class="item-artist">{{ item.artista }}</p>
              <span class="item-type">{{ getProductTypeLabel(item.tipo) }}</span>
            </div>

            <div class="item-actions">
              <span class="item-price">{{ formatPrice(item.precio) }}</span>
              <button 
                class="remove-btn"
                (click)="removeItem(item.id)"
                type="button"
                aria-label="Eliminar producto">
                <svg class="remove-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                  </path>
                </svg>
              </button>
            </div>
          </div>
        }
      </div>

      <!-- Resumen del carrito -->
      <div class="cart-summary">
        <h2 class="summary-title">Resumen del pedido</h2>
        
        <div class="summary-details">
          <div class="summary-row">
            <span class="summary-label">Productos ({{ cartSummary().itemCount }})</span>
            <span class="summary-value">{{ formatPrice(cartSummary().total) }}</span>
          </div>
          
          <div class="summary-divider"></div>
          
          <div class="summary-row summary-total">
            <span class="summary-label">Total</span>
            <span class="summary-value">{{ formatPrice(cartSummary().total) }}</span>
          </div>
        </div>

        <button 
          class="checkout-btn"
          (click)="checkout()"
          type="button">
          Proceder al pago
        </button>

        <a href="/home" class="continue-shopping">Continuar comprando</a>
      </div>
    </div>
  }
</div>